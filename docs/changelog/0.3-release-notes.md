# Yuxi-Know v0.3 更新说明

## 概览

Yuxi-Know v0.3 是一个重要的里程碑版本，包含了多项架构重构、功能增强和用户体验改进。本版本重点关注了系统架构的优化、数据存储的统一管理以及用户界面的现代化改进。

## 🔄 重大变更 (Breaking Changes)

### 环境配置文件位置调整
- **变更内容**: 将 `.env` 文件从 `src/.env` 移动到项目根目录 `.env`
- **影响**: 需要更新配置文件的复制命令和所有相关的文档引用
- **迁移指南**:
  ```bash
  # 旧版本
  cp src/.env.template src/.env

  # 新版本
  cp .env.template .env
  ```

### 配置文件管理调整

配置系统从 YAML 格式迁移到了基于 Pydantic BaseModel + TOML 的现代化配置系统。

| 项目 | v0.2.x | v0.3.x |
|------|--------|--------|
| 默认模型配置 | `src/config/static/models.yaml` | `src/config/static/models.py` |
| 用户配置 | `saves/config/base.yaml` | `saves/config/base.toml` |
| 配置格式 | YAML | Python 代码 + TOML |
| 类型安全 | ❌ 无 | ✅ Pydantic 验证 |
| IDE 支持 | ❌ 基础 | ✅ 完整智能提示 |
| 持久化策略 | 全量保存 | 选择性保存 |


示例：迁移自定义模型提供商

假设你的旧 `models.yaml` 中有：

```yaml
# 旧的 models.yaml
MODEL_NAMES:
  custom-provider:
    name: "My Custom Provider"
    base_url: "https://api.custom.com/v1"
    default: "custom-model"
    env: "CUSTOM_API_KEY"
    models:
      - "custom-model"
      - "another-model"
```

需要在新的 `src/config/static/models.py` 中添加：

```python
# 新的 models.py
DEFAULT_CHAT_MODEL_PROVIDERS: dict[str, ChatModelProvider] = {
    # ... 现有配置 ...

    "custom-provider": ChatModelProvider(
        name="My Custom Provider",
        url="https://custom.com/docs",
        base_url="https://api.custom.com/v1",
        default="custom-model",
        env="CUSTOM_API_KEY",
        models=["custom-model", "another-model"],
    ),
}
```


### 数据库存储架构重构
- **变更内容**: 重新实现了对话管理的存储与管理，不再依赖于 MemorySaver
- **影响**: 使用新的存储结构，之前存储的历史记录无法直接迁移
- **改进**: 所有对话记录统一保存到 `server.db` 中，提供更好的数据一致性和查询性能

### 自定义模型支持移除
- **变更内容**: 完全移除自定义模型支持功能
- **替代方案**: 使用自定义 provider

## ✨ 新增功能

### 1. Dashboard 统计面板
- **用户活跃度统计**: 提供用户使用情况的详细分析
- **工具调用统计**: 实时监控各种工具的使用频率和效果
- **知识库分析**: 展示知识库的使用情况和性能指标
- **智能体分析**: 统计智能体的调用次数和成功率
- **时间序列数据**: 支持历史趋势分析和可视化展示

### 2. 消息反馈系统
- **点赞点踩功能**: 用户可以对 AI 回复进行质量评价
- **反馈数据收集**: 为模型优化提供有价值的数据支持
- **管理员视图**: 管理员可以查看整体的反馈统计情况

### 3. 用户资料增强
- **用户名更新**: 支持用户修改显示名称
- **头像管理**: 完善用户头像上传和管理功能
- **账户安全**: 增强账户登录失败次数限制和锁定机制

### 4. 文档系统
- **VitePress 集成**: 添加完整的官方文档站点
- **快速开始指南**: 优化新用户的上手体验
- **配置文档**: 详细的环境配置和功能说明
- **GitHub Actions**: 实现文档的自动部署


**注意**: v0.3 版本包含多项重大变更，建议在升级前仔细阅读本文档并做好数据备份。如有问题，请通过 GitHub Issues 反馈。